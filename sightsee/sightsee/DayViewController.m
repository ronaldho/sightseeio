////  DayViewController.m//  sightsee////  Created by Ronald Ho on 2014-10-20.//  Copyright (c) 2014 Awesome Itinerary. All rights reserved.//#import "DayViewController.h"#import "AppDelegate.h"@interface DayViewController ()@property (nonatomic, strong) NSDictionary *jsonDictionary0;@property (nonatomic, strong) NSDictionary *jsonDictionary1;@property (nonatomic, strong) NSDictionary *jsonDictionary2;@property (nonatomic, strong) NSDictionary *jsonDictionary3;@property (nonatomic, strong) NSDictionary *jsonDictionary4;@property (nonatomic, strong) NSMutableDictionary *returnedDict ;//-(void)getLeJSON:(NSString*)city;@end@implementation DayViewController@synthesize city;- (void)viewDidLoad {    [super viewDidLoad];            // Do any additional setup after loading the view.        // Make self the delegate and datasource of the table view.    self.tblDayDetails.delegate = self;    self.tblDayDetails.dataSource = self;        // Initially hide the table view.    self.tblDayDetails.hidden = YES;}- (void)didReceiveMemoryWarning {    [super didReceiveMemoryWarning];    // Dispose of any resources that can be recreated.}-(IBAction)refresh:(id)sender{    self.tblDayDetails.hidden = NO;    [self getLeJSON:city];    [self.tblDayDetails reloadData];}/*#pragma mark - Navigation// In a storyboard-based application, you will often want to do a little preparation before navigation- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {    // Get the new view controller using [segue destinationViewController].    // Pass the selected object to the new view controller.}*/-(IBAction)cancel_button_touch:(id)sender {    [self dismissViewControllerAnimated:YES completion:nil];}-(void)getLeJSON:input{        NSLog(@"Field has value in getlejson: %@", input);    NSString *URLString = [NSString stringWithFormat:@"http://sitecio.herokuapp.com/requests/requests.json?loc=%@", input];//    NSString *URLString = [NSString stringWithFormat:@"http://sitecio.herokuapp.com/requests/requests.json?loc=seattle"];    //    NSString *URLString = [NSString stringWithFormat:@"https://dl.dropboxusercontent.com/u/3137747/mock.json"];        NSURL *url = [NSURL URLWithString:URLString];        [AppDelegate downloadDataFromURL:url withCompletionHandler:^(NSData *data) {        // Check if any data returned.        if (data != nil) {            // Convert the returned data into a dictionary.            NSError *error;            _returnedDict = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];            //            NSArray *returnedDict = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];            NSLog(@"Before IF ELSE");            if (error != nil) {                NSLog(@"%@", [error localizedDescription]);            }            else{                NSLog(@"In Else");                                //                NSArray *results= [returnedDict objectForKey:@"businesses"];                //                self.jsonDictionary0 =[returnedDict objectAtIndex:0];                //                self.jsonDictionary0 = [returnedDict objectForKey:@"businesses"];                self.jsonDictionary0 = [[_returnedDict objectForKey:@"businesses"] objectAtIndex:0];                self.jsonDictionary1 = [[_returnedDict objectForKey:@"businesses"] objectAtIndex:1];                self.jsonDictionary2 = [[_returnedDict objectForKey:@"businesses"] objectAtIndex:2];                self.jsonDictionary3 = [[_returnedDict objectForKey:@"businesses"] objectAtIndex:3];                self.jsonDictionary4 = [[_returnedDict objectForKey:@"businesses"] objectAtIndex:4];                                NSLog(@"%@", self.jsonDictionary0);                                                // Reload the table view.                NSLog(@"Reload data");                //                [self.tblDayDetails reloadData];                [self.tblDayDetails performSelectorOnMainThread:@selector(reloadData)                                                     withObject:nil                                                  waitUntilDone:NO];                [self viewDidLoad];                // Show the table view.                NSLog(@"before hidden");                self.tblDayDetails.hidden = NO;                NSLog(@"after hidden");            }                                    /*             // Set the country name to the respective label.             self.lblCountry.text = [NSString stringWithFormat:@"%@ (%@)", [self.countryDetailsDictionary objectForKey:@"countryName"], [self.countryDetailsDictionary objectForKey:@"countryCode"]];             */                                                        }    }];}#pragma mark - UITableView method implementation-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView{    return 1;}-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{    return 9;}-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"cell"];    if (cell == nil) {        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:@"Cell"];        cell.accessoryType = UITableViewCellAccessoryNone;        cell.selectionStyle = UITableViewCellSelectionStyleNone;    }    NSLog(@"Count: %d", [self.jsonDictionary0 count]);//    int row = indexPath.row % 3;//    int businessCounter = 0;    switch (indexPath.row ) {        case 0:            NSLog(@"inswitch 0");            cell.detailTextLabel.text = @"Business Name";            cell.textLabel.text = [self.jsonDictionary0 objectForKey:@"name" ];            break;        case 1:            NSLog(@"inswitch 1");            cell.detailTextLabel.text = @"Rating";            float ratingNumber = [[self.jsonDictionary0 objectForKey:@"rating"] floatValue];            cell.textLabel.text = [NSString stringWithFormat:@"%.01f", ratingNumber];//            cell.textLabel.text = [self.jsonDictionary0 objectForKey:@"location"];            break;        case 2:            NSLog(@"inswitch 2");            cell.detailTextLabel.text = @"Address";//            cell.textLabel.numberOfLines = 3;//            [NSString stringWithFormat:@"%@"[[self.jsonDictionary0 objectForKey:[@"location"] objectAtIndex:0] ];            NSLog([NSString stringWithFormat:@"%@",[[self.jsonDictionary0 objectForKey:@"location"] objectAtIndex:0] ] );            cell.textLabel.text = [NSString stringWithFormat:@"%@",[[self.jsonDictionary0 objectForKey:@"location"] objectAtIndex:0] ];            break;                                case 3:            NSLog(@"inswitch 0");            cell.detailTextLabel.text = @"Business Name";            cell.textLabel.text = [self.jsonDictionary1 objectForKey:@"name" ];            break;        case 4:            NSLog(@"inswitch 1");            cell.detailTextLabel.text = @"Rating";            float ratingNumber1 = [[self.jsonDictionary1 objectForKey:@"rating"] floatValue];            cell.textLabel.text = [NSString stringWithFormat:@"%.01f", ratingNumber1];            break;        case 5:            NSLog(@"inswitch 2");            cell.detailTextLabel.text = @"Address";            cell.textLabel.text = [NSString stringWithFormat:@"%@",[[self.jsonDictionary1 objectForKey:@"location"] objectAtIndex:0] ];            break;                                case 6:            NSLog(@"inswitch 0");            cell.detailTextLabel.text = @"Business Name";            cell.textLabel.text = [self.jsonDictionary2 objectForKey:@"name" ];            break;        case 7:            NSLog(@"inswitch 1");            cell.detailTextLabel.text = @"Rating";            float ratingNumber2 = [[self.jsonDictionary2 objectForKey:@"rating"] floatValue];            cell.textLabel.text = [NSString stringWithFormat:@"%.01f", ratingNumber2];            break;        case 8:            NSLog(@"inswitch 2");            cell.detailTextLabel.text = @"Address";            NSLog([NSString stringWithFormat:@"%@",[[self.jsonDictionary2 objectForKey:@"location"] objectAtIndex:0] ] );            cell.textLabel.text = [NSString stringWithFormat:@"%@",[[self.jsonDictionary2 objectForKey:@"location"] objectAtIndex:0] ];            break;                default:            break;    }    return cell;}/*-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{    return 60.0;} */-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{    if (indexPath.row == 6) {        [self performSegueWithIdentifier:@"idSegueNeighbours" sender:self];    }}@end